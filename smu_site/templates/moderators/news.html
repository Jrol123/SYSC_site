{% extends 'base.html' %}
{% load static %}

{% block title %}Responsive Animated Navbar{% endblock %}
{% block meta %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="keywords" content="">
    <meta name="description" content="">
{% endblock %}
<!-- IconFont and Stylesheet -->
{% block link %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" integrity="sha512-siarrzI1u3pCqFG2LEzi87McrBmq6Tp7juVsdmGY1Dr8Saw+ZBAzDzrGwX3vgxX1NkioYNCFOVC0GpDPss10zQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
	<script src="https://cdn.tiny.cloud/1/x9fbifsbf9wgj1k6nbzyfyhabvwcsb9ewleh0lajmfbfnvip/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
	
	<style>
		
	</style>

	<script type="text/javascript">
		tinymce.init({
			selector: '#myTextarea',
			skin: 'oxide-dark',
  			content_css: 'dark',
			plugins: [
			'advlist', 'autolink', 'link', 'image', 'lists', 'charmap', 'preview', 'anchor', 'pagebreak',
			'searchreplace', 'wordcount', 'visualblocks', 'visualchars', 'code', 'fullscreen', 'insertdatetime',
			'media', 'table', 'emoticons', 'template'
			],
			toolbar: 'undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | ' +
			'bullist numlist outdent indent | link image | print preview media fullscreen | ' +
			'forecolor backcolor emoticons | help | googlemap ',

			
	
			setup: function (editor) {
			  editor.ui.registry.addButton('googlemap', {
				text: 'Insert Map',
				onAction: function () {
				  let link = prompt("Enter the link here.");
				  
				  if(link != ""){
					const mapCode = '<iframe src="' + link + '" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>';
					editor.insertContent(mapCode);
				  }
				},
			  });
			},
			/* Block popup
			init_instance_callback : function(editor) {
				var freeTiny = document.querySelector('.tox .tox-notification--in');
			   freeTiny.style.display = 'none';
			  },*/
			menu: {
			favs: { title: 'My Favorites', items: 'code visualaid | searchreplace | emoticons' }
			},
			menubar: 'favs file edit view insert format tools table help',
			content_css: 'css/content.css',

			image_title: true, 
			// enable automatic uploads of images represented by blob or data URIs
			automatic_uploads: true,
			// add custom filepicker only to Image dialog
			file_picker_types: 'image',
			file_picker_callback: function(cb, value, meta) {
			  var input = document.createElement('input');
			  input.setAttribute('type', 'file');
			  input.setAttribute('accept', 'image/*');
		  
			  input.onchange = function() {
				var file = this.files[0];
				var reader = new FileReader();
				
				reader.onload = function () {
				  var id = 'blobid' + (new Date()).getTime();
				  var blobCache =  tinymce.activeEditor.editorUpload.blobCache;
				  var base64 = reader.result.split(',')[1];
				  var blobInfo = blobCache.create(id, file, base64);
				  blobCache.add(blobInfo);
		  
				  // call the callback and populate the Title field with the file name
				  cb(blobInfo.blobUri(), { title: file.name });
				};
				reader.readAsDataURL(file);
			  };
			  
			  input.click();
			}
		  });
	
		</script>

		<script>
			function call() {
			  var content =tinymce.get("myTextarea").getContent();
			  var blob = new Blob([content], { type: "text/plain" });
		
			  var a = document.createElement("a");
			  a.href = URL.createObjectURL(blob);
			  a.download = "output.txt";
			  document.body.appendChild(a);
			  a.click();
			  document.body.removeChild(a);
			}
		  </script>

{% endblock %}
<!--//-->



{% block content %}
	<div class="z-index:3">
    {% include "navbar.html" %}
	<div class="plates_home container-custom plate-container">
		<div class="Navbar_Moder plates col-lg-12 col-sm-12 col-md-12 col-xs-12 d-flex flex-row flex justify-content-center">
			<div class="links m-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:moder_guests' %}">Модерация предложений гостей</a>
			</div>
			<div class="links m-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:create_grant' %}">Гранты</a>
			</div>
			<div class="links m-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:gzs' %}">ГЖС</a>
			</div>
			<div class="links m-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:add_new_guests' %}">Добавление пользователей</a>
			</div>
			<div class="links m-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:profile' %}">Вернуться в главное окно модерации</a>
			</div>
            <div class="links ml-1 mr-1 col-lg-2 col-sm-2 col-md-2 col-xs-2 d-flex bg-black">
				<a href="{% url 'moderators:create_institute' %}">Добавление института</a>
			</div>
		</div>
	</div>
</div>

	

	<div style="position:relative; z-index:1 " class="container-custom redactor">
		<div class="pt-4 col-lg-12 col-md-12 col-sm-12">
			<form action="" method="POST">
				{% csrf_token %}
				<input type="text" class="form-control mt-2" style="height:4em; margin-bottom:1em" placeholder="название новости" required/>
				
				<textarea id="myTextarea" style="width:100%"></textarea>

				<input class="form-control" style="height:3em; margin-top:1 margin-bottom:1em"  type="file" id="formFileReadonly" readonly>
				<button type="submit" class="btn btn-primary">Upload</button>

				<button type="submit" class="btn btn-info" onclick="call()">Show generated html code</button>
			</form>
		</div> 

	</div>

	
    {% include "footer.html" %}

 
{% endblock %}
